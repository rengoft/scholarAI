{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[{"file_id":"1QKAHhTZ36t5L5ICwdabTT_Leq0cqJDm8","timestamp":1668714701063},{"file_id":"18a-r9sXQW7n_ydM8OoKFN2YaQvYwFkxR","timestamp":1667150773665}],"collapsed_sections":["kSc0W_B7oY63"],"authorship_tag":"ABX9TyP4Ps2CJYcE+/a/dFjEPUz7"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"gpuClass":"standard","accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"e2c724f2ad934c98831d0bfd8398a03e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_75d602de10bb4ce3be7deb26d2b80869","IPY_MODEL_4acdc6bff47b4cfcb3e5a8424c1513dc","IPY_MODEL_4c0541fee5724ea685e0c72067a6a952"],"layout":"IPY_MODEL_4300860957074b2fa3d5828c184fbe32"}},"75d602de10bb4ce3be7deb26d2b80869":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b829fc15fcfc4ee8817c75b3c2859589","placeholder":"​","style":"IPY_MODEL_347f5fddbe1a401cb01abecf9bc9ad82","value":" 67%"}},"4acdc6bff47b4cfcb3e5a8424c1513dc":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"danger","description":"","description_tooltip":null,"layout":"IPY_MODEL_0cdf5e0c4d9a46f29a89f9a5a344a254","max":3,"min":0,"orientation":"horizontal","style":"IPY_MODEL_98225db658f3453283a01f82a62c0908","value":2}},"4c0541fee5724ea685e0c72067a6a952":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_1bbd8228057b4c67b55126abd8f484c6","placeholder":"​","style":"IPY_MODEL_636b606ece1740158af90b663c5b8a99","value":" 2/3 [00:01&lt;00:00,  2.43ba/s]"}},"4300860957074b2fa3d5828c184fbe32":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b829fc15fcfc4ee8817c75b3c2859589":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"347f5fddbe1a401cb01abecf9bc9ad82":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0cdf5e0c4d9a46f29a89f9a5a344a254":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"98225db658f3453283a01f82a62c0908":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"1bbd8228057b4c67b55126abd8f484c6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"636b606ece1740158af90b663c5b8a99":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"dcf26367a521497c849caaeaf63084c5":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_316e65fbb31b41018e66b79fc74086bf","IPY_MODEL_0769ec2023ec4d9682d033e4e83f13dd","IPY_MODEL_2f0f9771ca86463ca312a1408231f739"],"layout":"IPY_MODEL_ca086c6d08ed48a3876a008a675af4f3"}},"316e65fbb31b41018e66b79fc74086bf":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d290542d0d2244769b0c96b951fbbf9a","placeholder":"​","style":"IPY_MODEL_fb1676cf93a142359ee750c8ddc960e1","value":"Downloading: 100%"}},"0769ec2023ec4d9682d033e4e83f13dd":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_ce2b7633bbd845ffbd912042db92da03","max":590,"min":0,"orientation":"horizontal","style":"IPY_MODEL_cc48e845df4c46b291dc65a0d30a4ace","value":590}},"2f0f9771ca86463ca312a1408231f739":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_7993871b0c374173ba6ea51d8e4decf0","placeholder":"​","style":"IPY_MODEL_3470d1b8d39b4751b319fabc5c48d965","value":" 590/590 [00:00&lt;00:00, 17.4kB/s]"}},"ca086c6d08ed48a3876a008a675af4f3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d290542d0d2244769b0c96b951fbbf9a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fb1676cf93a142359ee750c8ddc960e1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ce2b7633bbd845ffbd912042db92da03":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cc48e845df4c46b291dc65a0d30a4ace":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"7993871b0c374173ba6ea51d8e4decf0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3470d1b8d39b4751b319fabc5c48d965":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"109ad03a100f4b098f4ab05e2199995d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_2abf31688e794ab9a49bda3cbd6fb77b","IPY_MODEL_a9a629430d23451bb32a90950bf14fa0","IPY_MODEL_34d2e058f46e496ba62485d1f4ac8c4e"],"layout":"IPY_MODEL_a7362a87d6594f49b92327bb5cd8cc2a"}},"2abf31688e794ab9a49bda3cbd6fb77b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_45824c6670874118bf5ebe43ef35675a","placeholder":"​","style":"IPY_MODEL_257928b59b6a49f8b8d2b1732718d385","value":"Downloading: 100%"}},"a9a629430d23451bb32a90950bf14fa0":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_0ef1b6a3a20d4dbeb3d2afdefabcc9f8","max":1780720,"min":0,"orientation":"horizontal","style":"IPY_MODEL_8f0395ad4f2e42cdb66695050f84806c","value":1780720}},"34d2e058f46e496ba62485d1f4ac8c4e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_191387271b214e13a211aa3f4beb6450","placeholder":"​","style":"IPY_MODEL_cbd05dccdfcc449b9776dc9dfe3407f0","value":" 1.78M/1.78M [00:00&lt;00:00, 2.75MB/s]"}},"a7362a87d6594f49b92327bb5cd8cc2a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"45824c6670874118bf5ebe43ef35675a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"257928b59b6a49f8b8d2b1732718d385":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0ef1b6a3a20d4dbeb3d2afdefabcc9f8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8f0395ad4f2e42cdb66695050f84806c":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"191387271b214e13a211aa3f4beb6450":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cbd05dccdfcc449b9776dc9dfe3407f0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"5ab7d6ba918f422dae673584cec8bf43":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_a2ac506671564c0a97fcf60c50ce21fe","IPY_MODEL_8c9ff43e7f5b4eb89b0a9ae53458d94e","IPY_MODEL_2da2a7809a824de995299ac66d76ba2d"],"layout":"IPY_MODEL_d4bf735a6d824bbeb80620f975db598e"}},"a2ac506671564c0a97fcf60c50ce21fe":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2fd19678dc10416e8d2818fcb4f75408","placeholder":"​","style":"IPY_MODEL_d3a1c5b8902842cfaaae8f63d13b387f","value":" 88%"}},"8c9ff43e7f5b4eb89b0a9ae53458d94e":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"danger","description":"","description_tooltip":null,"layout":"IPY_MODEL_1f47936eb5f74597a1a743ecc040cd8f","max":8,"min":0,"orientation":"horizontal","style":"IPY_MODEL_4ebb1f1b066444aca1792f994038f7d0","value":7}},"2da2a7809a824de995299ac66d76ba2d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b43f8bc3975346828d754d41dce24855","placeholder":"​","style":"IPY_MODEL_705b750ce2bf4b428d9cd17d674d204e","value":" 7/8 [00:01&lt;00:00,  4.88ba/s]"}},"d4bf735a6d824bbeb80620f975db598e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2fd19678dc10416e8d2818fcb4f75408":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d3a1c5b8902842cfaaae8f63d13b387f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"1f47936eb5f74597a1a743ecc040cd8f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4ebb1f1b066444aca1792f994038f7d0":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"b43f8bc3975346828d754d41dce24855":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"705b750ce2bf4b428d9cd17d674d204e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c78d5bc01c3f456384dc094a45d1e923":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_9aaf6eb4e1064730b060a341a88e0890","IPY_MODEL_5b6b55e97e214695a85746e98366f7ba","IPY_MODEL_2d66ee18454842ad8fa98376c859af6c"],"layout":"IPY_MODEL_24cfbd038b0b4cf882528590a59962f7"}},"9aaf6eb4e1064730b060a341a88e0890":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_48fad83bfc30450ea61525c457f06a6b","placeholder":"​","style":"IPY_MODEL_e6b7d97d594b4292a211ab063b36c64b","value":" 67%"}},"5b6b55e97e214695a85746e98366f7ba":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"danger","description":"","description_tooltip":null,"layout":"IPY_MODEL_fc35aa4ae81842a0a58095a534ffb10e","max":3,"min":0,"orientation":"horizontal","style":"IPY_MODEL_bf29ac60d54543c3886d318bc1110d1e","value":2}},"2d66ee18454842ad8fa98376c859af6c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d9c51769cc694f998e773be568c01b85","placeholder":"​","style":"IPY_MODEL_051684c1a9ac4e6d8bd67bd40a4b84d1","value":" 2/3 [00:01&lt;00:00,  2.60ba/s]"}},"24cfbd038b0b4cf882528590a59962f7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"48fad83bfc30450ea61525c457f06a6b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e6b7d97d594b4292a211ab063b36c64b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"fc35aa4ae81842a0a58095a534ffb10e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bf29ac60d54543c3886d318bc1110d1e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"d9c51769cc694f998e773be568c01b85":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"051684c1a9ac4e6d8bd67bd40a4b84d1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"e7851606137b4664ba7d0c3811a5051c":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_b00908ecc86e4ca9af98a949c58c85d5","IPY_MODEL_7a98cc95296443ec8c8aa31d1b1bc02e","IPY_MODEL_13c54bad5d804f30835a9a844b91615c"],"layout":"IPY_MODEL_e7c20a9c8ac844dcbb44488919b6eb8d"}},"b00908ecc86e4ca9af98a949c58c85d5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_68fee5c238274737bbc7252e3389bc64","placeholder":"​","style":"IPY_MODEL_97e3dc54bec047a5ad4f4c77ee93b9fa","value":"Downloading builder script: 100%"}},"7a98cc95296443ec8c8aa31d1b1bc02e":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_c7e90faf5b464c1e828d68fdc12ab4ab","max":6338,"min":0,"orientation":"horizontal","style":"IPY_MODEL_422bce09e7ac4b5cb73d1994de375b21","value":6338}},"13c54bad5d804f30835a9a844b91615c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_4a4634ae975d4e83829fa1500e70e979","placeholder":"​","style":"IPY_MODEL_c9652be822984326adf58213b266592d","value":" 6.34k/6.34k [00:00&lt;00:00, 199kB/s]"}},"e7c20a9c8ac844dcbb44488919b6eb8d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"68fee5c238274737bbc7252e3389bc64":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"97e3dc54bec047a5ad4f4c77ee93b9fa":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c7e90faf5b464c1e828d68fdc12ab4ab":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"422bce09e7ac4b5cb73d1994de375b21":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"4a4634ae975d4e83829fa1500e70e979":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c9652be822984326adf58213b266592d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"4aed09ce96ba4bc7b8eecc318c034b3f":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_e1fb54c2eae14165bc8cb3e182e229a1","IPY_MODEL_3eaf5b325ba347c2ac3c7ba1dd097cb7","IPY_MODEL_7123de8ff3d34f09a47c1759f20b5e24"],"layout":"IPY_MODEL_42658e7172e4404880234627c612017d"}},"e1fb54c2eae14165bc8cb3e182e229a1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_635653d827b9481aac4156deed6aad4e","placeholder":"​","style":"IPY_MODEL_836b6f2acfe048dab99e885944100c49","value":"Downloading: 100%"}},"3eaf5b325ba347c2ac3c7ba1dd097cb7":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_429bb47bfb534b38a656e854cf72616d","max":716133354,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ee49132125ca475b8fa49aaebd8f6837","value":716133354}},"7123de8ff3d34f09a47c1759f20b5e24":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_cf9e6965f5344e5b92996d708f0b7ad2","placeholder":"​","style":"IPY_MODEL_5aba252d055f414595c1db41acaa92bd","value":" 716M/716M [00:27&lt;00:00, 19.8MB/s]"}},"42658e7172e4404880234627c612017d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"635653d827b9481aac4156deed6aad4e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"836b6f2acfe048dab99e885944100c49":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"429bb47bfb534b38a656e854cf72616d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ee49132125ca475b8fa49aaebd8f6837":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"cf9e6965f5344e5b92996d708f0b7ad2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5aba252d055f414595c1db41acaa92bd":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","source":["!pip install datasets\n","!pip install transformers"],"metadata":{"id":"ZM9ZA01FhhCq"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["!pip install seqeval\n","!pip install evaluate"],"metadata":{"id":"k5qUQcge2tDE"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import numpy as np\n","import pandas as pd\n","\n","from datasets import Dataset\n","from transformers import AutoTokenizer\n","from transformers import DataCollatorForTokenClassification\n","from transformers import AutoModelForTokenClassification\n","from transformers import TrainingArguments\n","from transformers import Trainer\n","import evaluate"],"metadata":{"id":"hpNh8jKmhj6U"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["### Подготовка датасетов из текстовых файлов."],"metadata":{"id":"2MaBNr4HIzpK"}},{"cell_type":"code","source":["# Функция парсинга текстового файла и создание списков токенов и лэйблов.\n","\n","def prepare_data(raw_data):\n","\n","    raw_tokens = []\n","    raw_labels = []\n","    current_sentence_labels = []\n","    current_sentence_tokens = []\n","\n","    for row in raw_data:\n","        if row == '\\n':\n","            raw_tokens.append(current_sentence_tokens)\n","            raw_labels.append(current_sentence_labels)\n","            current_sentence_labels = []\n","            current_sentence_tokens = []\n","            continue\n","      \n","        caret = 0\n","        current_token = ''\n","        while row[caret] != ' ':\n","            current_token += row[caret]\n","            caret += 1\n","        \n","        current_sentence_tokens.append(current_token)\n","        current_label = row[caret + 1: -1]\n","        current_sentence_labels.append(current_label)\n","    \n","    return raw_tokens, raw_labels"],"metadata":{"id":"n9vHgpoj9gZy"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# Функция создания упорядоченного списка уникальных меток из меток в данных\n","\n","def fetch_label_names(labels_list):    \n","    label_names = set()\n","    \n","    for sentence in labels_list:\n","        for label in sentence:\n","            label_names.add(label)\n","    \n","    list(label_names)\n","    \n","    temp_labels = []\n","    label_names.remove('O')\n","    for label in label_names:\n","        new_label = label[-3:] + '-' + label[0]\n","        temp_labels.append(new_label)\n","    \n","    temp_labels.sort()\n","    \n","    for i in range(len(temp_labels)):\n","        new_label = temp_labels[i][-1] + '-' + temp_labels[i][:3]\n","        temp_labels[i] = new_label\n","    \n","    temp_labels.insert(0, 'O')\n","    label_names = temp_labels\n","    \n","    return label_names\n","  "],"metadata":{"id":"GW01qRmblHoy"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7xANIbNN7YZ2","executionInfo":{"status":"ok","timestamp":1667232216314,"user_tz":-60,"elapsed":24295,"user":{"displayName":"Алексей Тяжев","userId":"10697695251284968559"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"1e05c9d3-aec4-4f75-fd58-21834a594194"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/gdrive\n"]}],"source":["# from google.colab import drive\n","# drive.mount('/content/gdrive')"]},{"cell_type":"code","source":["path='/content/train.txt'\n","\n","with open(path, 'r') as file:\n","    train_tokens, train_labels = prepare_data(file)"],"metadata":{"id":"_BaSKT0qPsEu"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["label_names = fetch_label_names(train_labels)\n","print(label_names)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"t4lx-CzopAeI","executionInfo":{"status":"ok","timestamp":1667377239500,"user_tz":-60,"elapsed":276,"user":{"displayName":"Алексей Тяжев","userId":"10697695251284968559"}},"outputId":"7c0cbe49-91c6-4cf6-86a4-99518f25ce16"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["['O', 'B-LOC', 'I-LOC', 'B-ORG', 'I-ORG', 'B-PER', 'I-PER']\n"]}]},{"cell_type":"code","source":["id2label = {i: label for i, label in enumerate(label_names)}\n","label2id = {v: k for k, v in id2label.items()}"],"metadata":{"id":"_Ksw3nTsnFru"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["train_labels = [[label2id[label_name] for label_name in sentence]\n","                for sentence in train_labels]\n","# print(train_labels[0],'\\n', train_labels[1],'\\n', train_labels[2],'\\n')"],"metadata":{"id":"pG4Dua4pq_8_"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["train_df = pd.DataFrame({'tokens': train_tokens, 'ner_tags': train_labels})"],"metadata":{"id":"Kogp6cykZPTu"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["train_dataset = Dataset.from_pandas(train_df)"],"metadata":{"id":"CgwzVI2GabqS"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["path='/content/dev.txt'\n","\n","with open(path, 'r') as file:\n","    val_tokens, val_labels = prepare_data(file)"],"metadata":{"id":"Y175JwvsXKQH"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["val_labels = [[label2id[label_name] for label_name in sentence]\n","              for sentence in val_labels]"],"metadata":{"id":"SdK43Q-JAnCo"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["val_df=pd.DataFrame({'tokens': val_tokens, 'ner_tags': val_labels})"],"metadata":{"id":"9HZFIpfDBAlt"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["val_dataset = Dataset.from_pandas(val_df)\n","val_dataset"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"gKrRmbf27P9i","executionInfo":{"status":"ok","timestamp":1667377271295,"user_tz":-60,"elapsed":9,"user":{"displayName":"Алексей Тяжев","userId":"10697695251284968559"}},"outputId":"d35075f8-3224-477d-a220-cf4363dfd3eb"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Dataset({\n","    features: ['tokens', 'ner_tags'],\n","    num_rows: 2582\n","})"]},"metadata":{},"execution_count":15}]},{"cell_type":"code","source":["model_checkpoint = \"sberbank-ai/ruBert-base\"\n","tokenizer = AutoTokenizer.from_pretrained(model_checkpoint)"],"metadata":{"id":"Vl2rCFs3XuJD","colab":{"base_uri":"https://localhost:8080/","height":81,"referenced_widgets":["dcf26367a521497c849caaeaf63084c5","316e65fbb31b41018e66b79fc74086bf","0769ec2023ec4d9682d033e4e83f13dd","2f0f9771ca86463ca312a1408231f739","ca086c6d08ed48a3876a008a675af4f3","d290542d0d2244769b0c96b951fbbf9a","fb1676cf93a142359ee750c8ddc960e1","ce2b7633bbd845ffbd912042db92da03","cc48e845df4c46b291dc65a0d30a4ace","7993871b0c374173ba6ea51d8e4decf0","3470d1b8d39b4751b319fabc5c48d965","109ad03a100f4b098f4ab05e2199995d","2abf31688e794ab9a49bda3cbd6fb77b","a9a629430d23451bb32a90950bf14fa0","34d2e058f46e496ba62485d1f4ac8c4e","a7362a87d6594f49b92327bb5cd8cc2a","45824c6670874118bf5ebe43ef35675a","257928b59b6a49f8b8d2b1732718d385","0ef1b6a3a20d4dbeb3d2afdefabcc9f8","8f0395ad4f2e42cdb66695050f84806c","191387271b214e13a211aa3f4beb6450","cbd05dccdfcc449b9776dc9dfe3407f0"]},"executionInfo":{"status":"ok","timestamp":1667377277738,"user_tz":-60,"elapsed":2136,"user":{"displayName":"Алексей Тяжев","userId":"10697695251284968559"}},"outputId":"902253ca-1334-4f81-a7b6-11b79fe9dd03"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/590 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"dcf26367a521497c849caaeaf63084c5"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/1.78M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"109ad03a100f4b098f4ab05e2199995d"}},"metadata":{}}]},{"cell_type":"code","source":["def align_labels_with_tokens(labels, word_ids):\n","    \n","    new_labels = []\n","    current_word = None\n","    for word_id in word_ids:\n","        if word_id is None:\n","            new_labels.append(-100)\n","        elif word_id != current_word:\n","            current_word = word_id\n","            label = labels[word_id]\n","            new_labels.append(label)\n","        else:\n","            label = labels[word_id]\n","            if label % 2 == 1:\n","                label += 1\n","            new_labels.append(label)\n","            \n","    return new_labels"],"metadata":{"id":"R-ZB4gCmaxar"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def tokenize_and_align_labels(examples):\n","    \n","    tokenized_inputs = tokenizer(\n","        examples[\"tokens\"],\n","        truncation=True,\n","        is_split_into_words=True\n","    )\n","\n","    all_labels = examples[\"ner_tags\"]\n","    new_labels = []\n","    for i, labels in enumerate(all_labels):\n","        word_ids = tokenized_inputs.word_ids(i)\n","        new_labels.append(align_labels_with_tokens(labels, word_ids))\n","\n","    tokenized_inputs[\"labels\"] = new_labels\n","    \n","    return tokenized_inputs"],"metadata":{"id":"co0HTcyyrj_L"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["train_tokenized = train_dataset.map(\n","    tokenize_and_align_labels,\n","    batched=True,\n","    remove_columns=train_dataset.column_names\n",")\n","\n","train_tokenized"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":136,"referenced_widgets":["5ab7d6ba918f422dae673584cec8bf43","a2ac506671564c0a97fcf60c50ce21fe","8c9ff43e7f5b4eb89b0a9ae53458d94e","2da2a7809a824de995299ac66d76ba2d","d4bf735a6d824bbeb80620f975db598e","2fd19678dc10416e8d2818fcb4f75408","d3a1c5b8902842cfaaae8f63d13b387f","1f47936eb5f74597a1a743ecc040cd8f","4ebb1f1b066444aca1792f994038f7d0","b43f8bc3975346828d754d41dce24855","705b750ce2bf4b428d9cd17d674d204e"]},"id":"DoLPxikRs1hZ","executionInfo":{"status":"ok","timestamp":1667377302321,"user_tz":-60,"elapsed":2849,"user":{"displayName":"Алексей Тяжев","userId":"10697695251284968559"}},"outputId":"e7e003fd-6efd-43f1-bc23-08819afd821e"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/8 [00:00<?, ?ba/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"5ab7d6ba918f422dae673584cec8bf43"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.\n"]},{"output_type":"execute_result","data":{"text/plain":["Dataset({\n","    features: ['input_ids', 'token_type_ids', 'attention_mask', 'labels'],\n","    num_rows: 7746\n","})"]},"metadata":{},"execution_count":19}]},{"cell_type":"code","source":["val_tokenized = val_dataset.map(\n","    tokenize_and_align_labels,\n","    batched=True,\n","    remove_columns=val_dataset.column_names\n",")\n","\n","val_tokenized"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":118,"referenced_widgets":["c78d5bc01c3f456384dc094a45d1e923","9aaf6eb4e1064730b060a341a88e0890","5b6b55e97e214695a85746e98366f7ba","2d66ee18454842ad8fa98376c859af6c","24cfbd038b0b4cf882528590a59962f7","48fad83bfc30450ea61525c457f06a6b","e6b7d97d594b4292a211ab063b36c64b","fc35aa4ae81842a0a58095a534ffb10e","bf29ac60d54543c3886d318bc1110d1e","d9c51769cc694f998e773be568c01b85","051684c1a9ac4e6d8bd67bd40a4b84d1"]},"id":"MXxRGhQB8G3H","executionInfo":{"status":"ok","timestamp":1667377313215,"user_tz":-60,"elapsed":1565,"user":{"displayName":"Алексей Тяжев","userId":"10697695251284968559"}},"outputId":"182e5547-5b1b-472c-f5ad-544407223f9b"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/3 [00:00<?, ?ba/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"c78d5bc01c3f456384dc094a45d1e923"}},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["Dataset({\n","    features: ['input_ids', 'token_type_ids', 'attention_mask', 'labels'],\n","    num_rows: 2582\n","})"]},"metadata":{},"execution_count":20}]},{"cell_type":"markdown","source":["### Решение задачи с помощью модели трансформера."],"metadata":{"id":"kSc0W_B7oY63"}},{"cell_type":"code","source":["data_collator = DataCollatorForTokenClassification(tokenizer=tokenizer)"],"metadata":{"id":"ACAIyus8BiDe"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["metric = evaluate.load(\"seqeval\")"],"metadata":{"id":"J9G-9eQgCSyn","colab":{"base_uri":"https://localhost:8080/","height":49,"referenced_widgets":["e7851606137b4664ba7d0c3811a5051c","b00908ecc86e4ca9af98a949c58c85d5","7a98cc95296443ec8c8aa31d1b1bc02e","13c54bad5d804f30835a9a844b91615c","e7c20a9c8ac844dcbb44488919b6eb8d","68fee5c238274737bbc7252e3389bc64","97e3dc54bec047a5ad4f4c77ee93b9fa","c7e90faf5b464c1e828d68fdc12ab4ab","422bce09e7ac4b5cb73d1994de375b21","4a4634ae975d4e83829fa1500e70e979","c9652be822984326adf58213b266592d"]},"executionInfo":{"status":"ok","timestamp":1667377330917,"user_tz":-60,"elapsed":22,"user":{"displayName":"Алексей Тяжев","userId":"10697695251284968559"}},"outputId":"5ab4b24f-f38d-4513-de7e-623abd7c6c44"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading builder script:   0%|          | 0.00/6.34k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"e7851606137b4664ba7d0c3811a5051c"}},"metadata":{}}]},{"cell_type":"code","source":["def compute_metrics(eval_preds):\n","    \n","    logits, labels = eval_preds\n","    predictions = np.argmax(logits, axis=-1)\n","    \n","    true_labels = [[label_names[l] for l in label if l != -100]\n","                   for label in labels]\n","    \n","    true_predictions = [[label_names[p] for (p, l) in zip(prediction, label) if l != -100]\n","                        for prediction, label in zip(predictions, labels)\n","                        ]\n","    \n","    all_metrics = metric.compute(predictions=true_predictions,\n","                                 references=true_labels\n","                                 )\n","    \n","    return {\n","        \"precision\": all_metrics[\"overall_precision\"],\n","        \"recall\": all_metrics[\"overall_recall\"],\n","        \"f1\": all_metrics[\"overall_f1\"],\n","        \"accuracy\": all_metrics[\"overall_accuracy\"],\n","    }"],"metadata":{"id":"H_BZ4umBCcj0"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def set_model():\n","    model = AutoModelForTokenClassification.from_pretrained(\n","        model_checkpoint,\n","        id2label=id2label,\n","        label2id=label2id,\n","    )\n","\n","    return model"],"metadata":{"id":"1lrH0nEEEb-J"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def set_training_args(num_train_epochs=3,\n","                      learning_rate=2e-5,\n","                      weight_decay=0.01\n","                      ):\n","  \n","    args = TrainingArguments(\n","        \"chekpoints-bert-finetuned-ner\",\n","        evaluation_strategy=\"epoch\",\n","        save_strategy=\"epoch\",\n","        learning_rate=learning_rate,\n","        num_train_epochs=num_train_epochs,\n","        weight_decay=weight_decay,   # Применяем регуляризацию в обучении.\n","    )\n","\n","    return args"],"metadata":{"id":"hGpbJaWoFYVE"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# Обучаем модель:\n","\n","model = set_model()\n","training_args = set_training_args(num_train_epochs=3,\n","                                  learning_rate=2e-5,\n","                                  weight_decay=0.01\n","                                  )\n","\n","trainer = Trainer(\n","    model=model,\n","    args=training_args,\n","    train_dataset=train_tokenized,\n","    eval_dataset=val_tokenized,\n","    data_collator=data_collator,\n","    compute_metrics=compute_metrics,\n","    tokenizer=tokenizer,\n",")\n","\n","trainer.train()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000,"referenced_widgets":["4aed09ce96ba4bc7b8eecc318c034b3f","e1fb54c2eae14165bc8cb3e182e229a1","3eaf5b325ba347c2ac3c7ba1dd097cb7","7123de8ff3d34f09a47c1759f20b5e24","42658e7172e4404880234627c612017d","635653d827b9481aac4156deed6aad4e","836b6f2acfe048dab99e885944100c49","429bb47bfb534b38a656e854cf72616d","ee49132125ca475b8fa49aaebd8f6837","cf9e6965f5344e5b92996d708f0b7ad2","5aba252d055f414595c1db41acaa92bd"]},"id":"NfcxdGl6Fs4U","executionInfo":{"status":"ok","timestamp":1667378157799,"user_tz":-60,"elapsed":552793,"user":{"displayName":"Алексей Тяжев","userId":"10697695251284968559"}},"outputId":"3d52db20-5d02-4647-8a72-eb437518ff65"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/716M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"4aed09ce96ba4bc7b8eecc318c034b3f"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Some weights of the model checkpoint at sberbank-ai/ruBert-base were not used when initializing BertForTokenClassification: ['cls.predictions.decoder.weight', 'cls.predictions.transform.dense.bias', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.seq_relationship.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.decoder.bias']\n","- This IS expected if you are initializing BertForTokenClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing BertForTokenClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","Some weights of BertForTokenClassification were not initialized from the model checkpoint at sberbank-ai/ruBert-base and are newly initialized: ['classifier.bias', 'classifier.weight']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n","/usr/local/lib/python3.7/dist-packages/transformers/optimization.py:310: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning\n","  FutureWarning,\n","***** Running training *****\n","  Num examples = 7746\n","  Num Epochs = 3\n","  Instantaneous batch size per device = 8\n","  Total train batch size (w. parallel, distributed & accumulation) = 8\n","  Gradient Accumulation steps = 1\n","  Total optimization steps = 2907\n","  Number of trainable parameters = 177722119\n","You're using a BertTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","    <div>\n","      \n","      <progress value='2907' max='2907' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [2907/2907 08:35, Epoch 3/3]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n"," <tr style=\"text-align: left;\">\n","      <th>Epoch</th>\n","      <th>Training Loss</th>\n","      <th>Validation Loss</th>\n","      <th>Precision</th>\n","      <th>Recall</th>\n","      <th>F1</th>\n","      <th>Accuracy</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <td>1</td>\n","      <td>0.183900</td>\n","      <td>0.057887</td>\n","      <td>0.920046</td>\n","      <td>0.922870</td>\n","      <td>0.921456</td>\n","      <td>0.981097</td>\n","    </tr>\n","    <tr>\n","      <td>2</td>\n","      <td>0.033400</td>\n","      <td>0.051539</td>\n","      <td>0.943891</td>\n","      <td>0.945702</td>\n","      <td>0.944796</td>\n","      <td>0.985110</td>\n","    </tr>\n","    <tr>\n","      <td>3</td>\n","      <td>0.017100</td>\n","      <td>0.055933</td>\n","      <td>0.947950</td>\n","      <td>0.953952</td>\n","      <td>0.950942</td>\n","      <td>0.986099</td>\n","    </tr>\n","  </tbody>\n","</table><p>"]},"metadata":{}},{"output_type":"stream","name":"stderr","text":["***** Running Evaluation *****\n","  Num examples = 2582\n","  Batch size = 8\n","Saving model checkpoint to chekpoints-bert-finetuned-ner/checkpoint-969\n","Configuration saved in chekpoints-bert-finetuned-ner/checkpoint-969/config.json\n","Model weights saved in chekpoints-bert-finetuned-ner/checkpoint-969/pytorch_model.bin\n","tokenizer config file saved in chekpoints-bert-finetuned-ner/checkpoint-969/tokenizer_config.json\n","Special tokens file saved in chekpoints-bert-finetuned-ner/checkpoint-969/special_tokens_map.json\n","***** Running Evaluation *****\n","  Num examples = 2582\n","  Batch size = 8\n","Saving model checkpoint to chekpoints-bert-finetuned-ner/checkpoint-1938\n","Configuration saved in chekpoints-bert-finetuned-ner/checkpoint-1938/config.json\n","Model weights saved in chekpoints-bert-finetuned-ner/checkpoint-1938/pytorch_model.bin\n","tokenizer config file saved in chekpoints-bert-finetuned-ner/checkpoint-1938/tokenizer_config.json\n","Special tokens file saved in chekpoints-bert-finetuned-ner/checkpoint-1938/special_tokens_map.json\n","***** Running Evaluation *****\n","  Num examples = 2582\n","  Batch size = 8\n","Saving model checkpoint to chekpoints-bert-finetuned-ner/checkpoint-2907\n","Configuration saved in chekpoints-bert-finetuned-ner/checkpoint-2907/config.json\n","Model weights saved in chekpoints-bert-finetuned-ner/checkpoint-2907/pytorch_model.bin\n","tokenizer config file saved in chekpoints-bert-finetuned-ner/checkpoint-2907/tokenizer_config.json\n","Special tokens file saved in chekpoints-bert-finetuned-ner/checkpoint-2907/special_tokens_map.json\n","\n","\n","Training completed. Do not forget to share your model on huggingface.co/models =)\n","\n","\n"]},{"output_type":"execute_result","data":{"text/plain":["TrainOutput(global_step=2907, training_loss=0.05904384540207492, metrics={'train_runtime': 517.9452, 'train_samples_per_second': 44.866, 'train_steps_per_second': 5.613, 'total_flos': 652257830000172.0, 'train_loss': 0.05904384540207492, 'epoch': 3.0})"]},"metadata":{},"execution_count":26}]},{"cell_type":"code","source":["# Посмотрим на метрики модели, полученные при ее валидации:\n","\n","eval_results = trainer.evaluate()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":89},"id":"FTFY0ComfQ6J","executionInfo":{"status":"ok","timestamp":1667378281908,"user_tz":-60,"elapsed":11509,"user":{"displayName":"Алексей Тяжев","userId":"10697695251284968559"}},"outputId":"08d1cf76-b5cf-4f25-a82f-444a90a90430"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["***** Running Evaluation *****\n","  Num examples = 2582\n","  Batch size = 8\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","    <div>\n","      \n","      <progress value='323' max='323' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [323/323 00:10]\n","    </div>\n","    "]},"metadata":{}}]},{"cell_type":"code","source":["print(list(eval_results.keys()))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"dhQemnQ7fjoh","executionInfo":{"status":"ok","timestamp":1667378333498,"user_tz":-60,"elapsed":278,"user":{"displayName":"Алексей Тяжев","userId":"10697695251284968559"}},"outputId":"18e635e2-85bd-4845-8d32-7b8429ae4fef"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["['eval_loss', 'eval_precision', 'eval_recall', 'eval_f1', 'eval_accuracy', 'eval_runtime', 'eval_samples_per_second', 'eval_steps_per_second', 'epoch']\n"]}]},{"cell_type":"code","source":["print(eval_results['eval_recall'])\n","print(eval_results['eval_accuracy'])\n","print(eval_results['eval_f1'])\n","print(eval_results['eval_precision'])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"PoVMxioJfDjd","executionInfo":{"status":"ok","timestamp":1667378397045,"user_tz":-60,"elapsed":479,"user":{"displayName":"Алексей Тяжев","userId":"10697695251284968559"}},"outputId":"50a21b15-879a-43d4-fdb6-39638a689b6d"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["0.9539524174980814\n","0.986098993776537\n","0.9509419527589175\n","0.9479504289799809\n"]}]},{"cell_type":"code","source":["# Приготовим тестовый датасет для предсказания моделью\n","\n","path = '/content/test.txt'\n","\n","with open(path, 'r') as file:\n","    test_tokens, test_labels = prepare_data(file)"],"metadata":{"id":"-VV3I6PBk-vL"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["test_labels = [[label2id[label_name] for label_name in sentence]\n","               for sentence in test_labels]\n","# val_labels[:3]\n","test_df = pd.DataFrame({'tokens':test_tokens,\n","                        'ner_tags':test_labels\n","                        })\n","# val_df[:5]\n","test_dataset = Dataset.from_pandas(test_df)\n","test_dataset"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Hfw4JxSflPi-","executionInfo":{"status":"ok","timestamp":1667247166414,"user_tz":-60,"elapsed":334,"user":{"displayName":"Алексей Тяжев","userId":"10697695251284968559"}},"outputId":"4ca03e1d-ca66-4a07-8e4b-5c49d5e4f5b1"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Dataset({\n","    features: ['tokens', 'ner_tags'],\n","    num_rows: 2582\n","})"]},"metadata":{},"execution_count":30}]},{"cell_type":"code","source":["test_tokenized = test_dataset.map(\n","    tokenize_and_align_labels,\n","    batched=True,\n","    remove_columns=test_dataset.column_names\n",")\n","\n","test_tokenized"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":118,"referenced_widgets":["e2c724f2ad934c98831d0bfd8398a03e","75d602de10bb4ce3be7deb26d2b80869","4acdc6bff47b4cfcb3e5a8424c1513dc","4c0541fee5724ea685e0c72067a6a952","4300860957074b2fa3d5828c184fbe32","b829fc15fcfc4ee8817c75b3c2859589","347f5fddbe1a401cb01abecf9bc9ad82","0cdf5e0c4d9a46f29a89f9a5a344a254","98225db658f3453283a01f82a62c0908","1bbd8228057b4c67b55126abd8f484c6","636b606ece1740158af90b663c5b8a99"]},"id":"BEO98FOOlmVO","executionInfo":{"status":"ok","timestamp":1667247174162,"user_tz":-60,"elapsed":1411,"user":{"displayName":"Алексей Тяжев","userId":"10697695251284968559"}},"outputId":"bf78bccf-8b51-44cc-865c-cededc2c63a0"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/3 [00:00<?, ?ba/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"e2c724f2ad934c98831d0bfd8398a03e"}},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["Dataset({\n","    features: ['input_ids', 'token_type_ids', 'attention_mask', 'labels'],\n","    num_rows: 2582\n","})"]},"metadata":{},"execution_count":31}]},{"cell_type":"code","source":["# Делаем предсказание:\n","\n","prediction = trainer.predict(\n","    test_dataset=test_tokenized,\n","    metric_key_prefix='test'\n","    )"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":69},"id":"LQzP88F3mLmA","executionInfo":{"status":"ok","timestamp":1667247193415,"user_tz":-60,"elapsed":14624,"user":{"displayName":"Алексей Тяжев","userId":"10697695251284968559"}},"outputId":"4587c885-fc14-4050-f4fc-05789f20d4b2"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["***** Running Prediction *****\n","  Num examples = 2582\n","  Batch size = 8\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":[]},"metadata":{}}]},{"cell_type":"code","source":["print(prediction.metrics)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"303TE5VgrmXg","executionInfo":{"status":"ok","timestamp":1667247339160,"user_tz":-60,"elapsed":567,"user":{"displayName":"Алексей Тяжев","userId":"10697695251284968559"}},"outputId":"31db05f6-ca2e-4e23-e6fd-2fc9e1bf6442"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["{'test_loss': 0.04669163003563881, 'test_precision': 0.9500363372093024, 'test_recall': 0.9531534815895005, 'test_f1': 0.9515923566878981, 'test_accuracy': 0.988324388119257, 'test_runtime': 13.5704, 'test_samples_per_second': 190.267, 'test_steps_per_second': 23.802}\n"]}]}]}